# Syringe Detection and Tracking

This directory contains the system for detecting and tracking syringes in video streams using the Ultralytics YOLOv11 object detection model and the ByteTrack tracking algorithm.

## Purpose

This module identifies syringe instances in each frame and assigns a consistent ID to each detected syringe across frames, enabling tracking of individual syringes over time.

## Files

-   `train.py`: Script for training the YOLO object detection model. Requires a dataset (e.g., in YOLO format, potentially generated using the `dino` module or downloaded) and configuration.
-   `video_inference_od.ipynb`: Jupyter Notebook for running detection and tracking on pre-recorded video files.
-   `webcam_inference_od.ipynb`: Jupyter Notebook for running real-time detection and tracking using a webcam feed.
-   `bytetrack_od.yaml`: Configuration file for the ByteTrack tracker parameters (e.g., thresholds, frame rates).
-   `runs/`: Default output directory for training results (models, logs, etc.) generated by `train.py`.

## Usage

1.  **Prepare Dataset:**
    Ensure you have a dataset suitable for training YOLO object detection. Annotations should be in YOLO format (typically `.txt` files alongside images). You might use the output from the `dino` module or datasets downloaded via `download_datasets.ipynb`.

2.  **Train the Detection Model (Optional):**
    If you need to train a custom detector, use the provided `train.py` script. This script utilizes the Ultralytics YOLOv11 library.
    **Important:** Modify the parameters (like dataset path, model configuration, epochs, image size, etc.) directly *within* the `train.py` script itself.
    Once configured, execute the script from the terminal:
    ```bash
    python train.py
    ```
    Trained models will typically be saved in the `runs/detect/train*/weights/` directory.

3.  **Run Inference:**
    -   **Video File:** Open and run `video_inference_od.ipynb`. Update the video path and the path to your trained YOLO model weights (`.pt` file) within the notebook.
    -   **Webcam:** Open and run `webcam_inference_od.ipynb`. Ensure the correct webcam index and the path to your trained YOLO model weights are set.

## Configuration

-   **Tracker:** Modify `bytetrack_od.yaml` to adjust ByteTrack parameters if necessary.
-   **Training:** YOLO training configuration (dataset paths, hyperparameters) is typically managed through a dataset YAML file (e.g., `data.yaml`) and command-line arguments passed to `train.py`.
